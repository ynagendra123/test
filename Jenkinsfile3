pipeline {
	agent any 
	environment {
	 NEW_VERSION = '1.3.0'
	 FULL_PATH_BRANCH = "${sh(script:'git name-rev --name-only HEAD', returnStdout: true)}"
     GIT_BRANCH = FULL_PATH_BRANCH.substring(FULL_PATH_BRANCH.lastIndexOf('/') + 1, FULL_PATH_BRANCH.length())
	 branch = "${env.GIT_BRANCH}"
	            }
	 tools {
	        maven 'Maven' 
		   }
		   
	  stages {
			   stage('one') {
		                steps {
								echo "this is 1st stage"
								echo "the branch name is ${branch}"
								echo "the branch name is env.BRANCH_NAME"
							  }
							}
			   stage('two') {
			           when {
					      expression { "${branch}" == "main" }
					  }
						 steps {
								 echo "this is 2nd stage"
								 echo "the version of buils is ${NEW_VERSION}"
								}
							}
			   stage('three') {
						  steps {
								   echo "this is the 3rd stage"
								}
							  }
				}
				post {
				 always {
				         echo "running always" 	
						}
				 success {
				        echo "the build is success"
						 }
				 failure {
						echo "the build is falied"
				         }
				    }
		  }
